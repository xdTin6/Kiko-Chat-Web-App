<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KikoChat</title>

<script type="module">
// ... (your existing JavaScript code remains exactly the same) ...
</script>

<style>
/* --- Global Styles & Variables --- */
:root {
  --background-dark: #0d1117;
  --panel-bg: #161b22;
  --panel-border: #30363d;
  --text-primary: #e6edf3;
  --text-secondary: #7d8590;
  --accent-color: #2f81f7;
  --accent-hover: #58a6ff;
  --my-bubble-bg: #224368;
  --other-bubble-bg: #21262d;
  --online-indicator: #238636;
}
* { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
html, body { 
  height: 100%; 
  overflow: hidden; 
  background-color: var(--background-dark); 
  color: var(--text-primary); 
  font-size: 14px; /* Base font size */
}

/* --- Login View --- */
#loginView { 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  width: 100%; 
  height: 100%; 
  padding: 16px; /* Added padding for mobile */
}
.loginCard { 
  background: var(--panel-bg); 
  padding: 24px; 
  width: 100%; 
  max-width: 350px; 
  border-radius: 12px; 
  text-align: center; 
  border: 1px solid var(--panel-border); 
}
.logoWrap { 
  display: flex; 
  align-items: center; 
  gap: 10px; 
  justify-content: center; 
  margin-bottom: 20px; 
}
.logoCat { 
  width: 44px; 
  height: 44px; 
  border-radius: 12px; 
  background: var(--accent-color); 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-size: 24px; 
}
.logoText { 
  font-size: 22px; 
  font-weight: 600; 
}
.loginCard input { 
  width: 100%; 
  padding: 12px; 
  margin: 8px 0; 
  border: 1px solid var(--panel-border); 
  border-radius: 8px; 
  background: var(--background-dark); 
  color: var(--text-primary); 
  outline: none; 
  font-size: 16px; /* Better for mobile */
}
.loginCard input:focus { 
  border-color: var(--accent-color); 
}
.loginCard button { 
  margin-top: 10px; 
  width: 100%; 
  padding: 12px; 
  border: none; 
  border-radius: 8px; 
  background: var(--accent-color); 
  color: #fff; 
  font-weight: 600; 
  cursor: pointer; 
  transition: background-color 0.2s; 
  font-size: 16px; /* Better for mobile */
}
.loginCard button:hover { 
  background: var(--accent-hover); 
}

/* --- Main Chat View (Desktop) --- */
#mainView { 
  width: 100%; 
  height: 100%; 
  display: grid; 
  grid-template-columns: minmax(250px, 340px) 1fr; /* More flexible sizing */
}
.leftPanel, .rightPanel { 
  display: flex; 
  flex-direction: column; 
  background: var(--panel-bg); 
  height: 100%; 
}
.leftPanel { 
  border-right: 1px solid var(--panel-border); 
}
.panelHeader { 
  padding: 12px 16px; 
  border-bottom: 1px solid var(--panel-border); 
  display: flex; 
  align-items: center; 
  gap: 10px; 
  font-weight: 600; 
  min-height: 60px; /* Fixed height for consistency */
}
.panelHeader .logoCat { 
  width: 36px; 
  height: 36px; 
  font-size: 20px; 
  border-radius: 10px; 
}
.panelHeader .logoText { 
  font-size: 18px; 
}
#usersList { 
  flex: 1; 
  overflow-y: auto; 
  padding: 8px; 
  display: flex; 
  flex-direction: column; 
}
.userItem { 
  display: flex; 
  align-items: center; 
  gap: 12px; 
  padding: 10px; 
  border-radius: 8px; 
  cursor: pointer; 
  transition: background-color 0.2s; 
}
.userItem:hover { 
  background: rgba(255, 255, 255, 0.05); 
}
.miniAvatar { 
  width: 40px; 
  height: 40px; 
  border-radius: 50%; 
  flex-shrink: 0; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-weight: 600; 
  color: #fff; 
}
.userInfo { 
  flex: 1; 
  min-width: 0; /* Prevents overflow */
}
.userName { 
  font-weight: 500; 
  font-size: 15px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.userStatus { 
  font-size: 13px; 
  color: var(--text-secondary); 
}
.userStatus:first-letter { 
  text-transform: uppercase; 
}

/* Admin Panel */
#adminPanel { 
  flex-wrap: wrap; 
  gap: 8px; 
  padding: 12px; 
  border-top: 1px solid var(--panel-border); 
  background: var(--background-dark); 
}
#adminPanel input { 
  flex: 1; 
  min-width: 120px;
  padding: 10px; 
  border-radius: 6px; 
  border: 1px solid var(--panel-border); 
  background: var(--panel-bg); 
  color: var(--text-primary); 
  font-size: 14px; 
}
#adminPanel button { 
  padding: 10px 12px; 
  border-radius: 6px; 
  border: none; 
  cursor: pointer; 
  font-weight: 500; 
  background: #333; 
  color: #fff; 
  font-size: 14px; 
  flex: 1;
  min-width: 100px;
}
#adminPanel button:last-of-type { 
  background: #c62828; 
}

/* Right Panel (Chat Area) */
.topbar { 
  padding: 0 16px; 
  height: 60px; 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  border-bottom: 1px solid var(--panel-border); 
  flex-shrink: 0; 
}
#backToUsersBtn { 
  display: none; 
  background: none; 
  border: none; 
  color: var(--text-primary); 
  font-size: 22px; 
  cursor: pointer; 
  margin-right: 10px; 
  padding: 8px;
}
#meInfo strong { 
  font-size: 16px; 
}
#meInfo span { 
  color: var(--text-secondary); 
  font-size: 13px; 
  margin-left: 4px; 
}
#logoutBtn { 
  background: #c62828; 
  padding: 8px 14px; 
  border-radius: 6px; 
  border: none; 
  color: #fff; 
  cursor: pointer; 
  font-size: 14px;
}
#messages { 
  flex: 1; 
  overflow-y: auto; 
  padding: 16px;
  display: flex; 
  flex-direction: column; 
  gap: 8px; 
  background-color: var(--background-dark);
  min-height: 0;
}
.msgRow { 
  display: flex; 
  max-width: 80%; /* Slightly increased for better readability */
  margin-bottom: 8px; 
}
.msgRow.me { 
  align-self: flex-end; 
}
.msgRow.other { 
  align-self: flex-start; 
}
.bubble { 
  padding: 10px 14px; 
  border-radius: 16px; 
  color: var(--text-primary); 
  max-width: 100%; 
  word-wrap: break-word; 
}
.msgRow.me .bubble { 
  background: var(--my-bubble-bg); 
  border-bottom-right-radius: 4px; 
}
.msgRow.other .bubble { 
  background: var(--other-bubble-bg); 
  border-bottom-left-radius: 4px; 
}
.bubble .meta { 
  font-size: 12px; 
  opacity: 0.8; 
}
.bubble .meta.name { 
  font-weight: 600; 
  margin-bottom: 4px; 
}
.bubble .meta.footer { 
  text-align: right; 
  margin-top: 6px; 
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 4px;
}
.bubble .text { 
  line-height: 1.4; 
  white-space: pre-wrap; 
  font-size: 15px;
}
.chat-media { 
  max-width: 100%; 
  max-height: 300px;
  border-radius: 10px; 
  margin-top: 5px; 
}
.ticks { 
  margin-left: 5px; 
  font-size: 14px; 
  font-weight: bold; 
}
.composer { 
  display: flex; 
  gap: 10px; 
  align-items: flex-end; 
  padding: 12px 16px; 
  border-top: 1px solid var(--panel-border); 
  flex-shrink: 0; 
}
.composer textarea {
  flex: 1;
  padding: 12px 16px;
  border: none;
  border-radius: 20px;
  background: var(--other-bubble-bg);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 15px;
  line-height: 1.4;
  outline: none;
  resize: none;
  overflow-y: auto;
  max-height: 120px;
  min-height: 44px; /* Better touch target on mobile */
}
.composer textarea::-webkit-scrollbar { 
  width: 5px; 
}
.composer textarea::-webkit-scrollbar-thumb { 
  background-color: var(--panel-border); 
  border-radius: 10px; 
}
.composer button { 
  width: 44px; 
  height: 44px; 
  border: none; 
  border-radius: 50%; 
  background: var(--accent-color); 
  color: #fff; 
  font-size: 18px; 
  flex-shrink: 0; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  cursor: pointer; 
}

/* --- Mobile Responsive Design --- */
@media (max-width: 1024px) {
  #mainView { 
    grid-template-columns: minmax(200px, 280px) 1fr; 
  }
}

@media (max-width: 768px) {
  html, body {
    font-size: 15px; /* Slightly larger base font for mobile */
  }
  
  #mainView { 
    grid-template-columns: 1fr; 
  }
  .leftPanel, .rightPanel { 
    position: absolute; 
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%; 
    transition: transform 0.3s ease-in-out; 
  }
  .leftPanel { 
    z-index: 10; 
  }
  .rightPanel { 
    transform: translateX(100%); 
    z-index: 20; 
  }
  body.show-chat-panel .leftPanel { 
    transform: translateX(-100%); 
  }
  body.show-chat-panel .rightPanel { 
    transform: translateX(0); 
  }
  .topbar { 
    padding: 0 12px; 
  }
  #backToUsersBtn { 
    display: block; 
  }
  .msgRow {
    max-width: 90%; /* More width on mobile */
  }
  .composer {
    padding: 10px 12px;
  }
}

@media (max-width: 480px) {
  .loginCard {
    padding: 20px;
  }
  
  .panelHeader {
    padding: 12px;
  }
  
  .userItem {
    padding: 8px;
  }
  
  #messages {
    padding: 12px;
  }
  
  .bubble {
    padding: 8px 12px;
  }
  
  .composer {
    gap: 8px;
  }
  
  .composer button {
    width: 40px;
    height: 40px;
  }
  
  #adminPanel {
    padding: 10px;
  }
  
  #adminPanel input, #adminPanel button {
    min-width: 0;
    flex: 1 1 100%;
  }
}

@media (max-width: 768px) and (orientation: landscape) {
  .panelHeader {
    min-height: 50px;
    padding: 8px 12px;
  }
  
  .topbar {
    height: 50px;
  }
  
  .composer { 
    padding: 8px 12px; 
    align-items: center;
  }
  
  .composer textarea { 
    max-height: 80px; 
    min-height: 36px;
  }
  
  .composer button { 
    width: 40px; 
    height: 40px; 
  }
}
</style>
</head>
<body>

<!-- Your existing HTML remains exactly the same -->
<div id="loginView">
  <div class="loginCard">
    <div class="logoWrap"><div class="logoCat">üê±</div><div class="logoText">KikoChat</div></div>
    <input id="usernameLogin" placeholder="Username"/>
    <input id="passLogin" type="password" placeholder="Passcode"/>
    <button id="loginButton">Login</button>
  </div>
</div>

<div id="mainView" style="display:none">
  <div class="leftPanel">
    <div class="panelHeader">
        <div class="logoCat">üê±</div>
        <div class="logoText">KikoChat</div>
    </div>
    <div id="usersList"></div>
    <div id="adminPanel" style="display:none">
      <input id="newUsername" placeholder="username"/>
      <input id="newPass" placeholder="pass"/>
      <button id="addUserBtn">+ User</button>
      <button id="addAdminBtn">+ Admin</button>
      <button id="clearChatBtn">Clear Chat</button>
    </div>
  </div>
  <div class="rightPanel">
    <div class="topbar">
      <div style="display: flex; align-items: center;">
        <button id="backToUsersBtn" aria-label="Back to users list">&larr;</button>
        <div id="meInfo">
            <strong id="meName"></strong> <span id="meRole"></span>
        </div>
      </div>
      <button id="logoutBtn">Logout</button>
    </div>
    <div id="messages"></div>
    <div class="composer">
      <button id="attachBtn">üìé</button>
      <input type="file" id="fileInput" accept="image/*,video/*" hidden/>
      <textarea id="textInput" placeholder="Type a message..." rows="1"></textarea>
      <button id="sendBtn">‚û§</button>
    </div>
  </div>
</div>

</body>
</html>
